(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{69636:function(e,t,n){Promise.resolve().then(n.bind(n,1034))},1034:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(57437),i=n(2265),l=n(27648);function s(){let e=(0,i.useRef)(null),t=(0,i.useRef)(null),n=(0,i.useRef)(null),s=(0,i.useRef)(null),a=(0,i.useRef)(null),c=(0,i.useRef)(null),o=(0,i.useRef)(null),u=(0,i.useRef)(null),d=(0,i.useRef)(null),f=(0,i.useRef)(null),p=(0,i.useRef)(null),x=(0,i.useRef)(null),h=(0,i.useRef)(null),m=(0,i.useRef)(null),g=(0,i.useRef)(null),v={startBtn:e,stopBtn:t,transcriptEl:n,lastQuestionEl:s,answerEl:a,resumeBox:c,micStatusEl:o,recStatusEl:u,deviceSelect:d,refreshBtn:f,supportEl:p,secureEl:x,vuEl:h,vuLabel:m,diagMsg:g};return(0,i.useEffect)(()=>(function(e){let{startBtn:t,stopBtn:n,transcriptEl:r,lastQuestionEl:i,answerEl:l,resumeBox:s,micStatusEl:a,recStatusEl:c,deviceSelect:o,refreshBtn:u,supportEl:d,secureEl:f,vuEl:p,vuLabel:x,diagMsg:h}=e,m=window.SpeechRecognition||window.webkitSpeechRecognition,g=null,v=!1,b=!1,w="",y="",j="",N=[],k=null,R=0,C=[500,1e3,2e3,3e3],E=0,S=null,L=null,I=null,M=null,T=null,D=null;function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a.current&&(a.current.textContent=e?"Mic Listening":"Mic Stopped"+(t?" (".concat(t,")"):""),a.current.classList.toggle("on",e),a.current.classList.toggle("off",!e))}function q(e){if(!c.current)return;c.current.textContent="Recognizer ".concat(e);let t=["Ready","Listening","Restarting"].includes(e);c.current.classList.toggle("on",t),c.current.classList.toggle("off",!t)}function z(e){h.current&&(h.current.textContent=e)}function B(){w="",y="",j="",N=[],r.current&&(r.current.textContent="")}function O(e){let t=e.replace(/\s+/g," ").trim().split(RegExp("(?<=[\\.\\?\\!])\\s+"));if(!t.length)return"";for(let e=t.length-1;e>=0;e--){let n=t[e].trim();if(n.endsWith("?")&&n.length>2)return n}return t[t.length-1].trim()}function _(){let e=((j||w)+(y?" "+y:"")).trim().replace(/\b(um+|uh+|erm+|like|you know)\b/gi,"").replace(/\s{2,}/g," ").trim();return(O(e)||e).trim()}async function P(){if(o.current)try{let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind);o.current.innerHTML="",e.forEach(e=>{let t=document.createElement("option");t.value=e.deviceId,t.textContent=e.label||"Mic (".concat(e.deviceId.slice(0,6),"...)"),o.current.appendChild(t)}),k&&e.some(e=>e.deviceId===k)?o.current.value=k:e[0]&&(o.current.value=e[0].deviceId,k=e[0].deviceId),e.length||z("No audio input devices found.")}catch(e){z("Could not enumerate devices. Grant mic permission first.")}}async function H(){if(U(),p.current&&x.current)try{L=await navigator.mediaDevices.getUserMedia({audio:!k||{deviceId:{exact:k}}}),(M=(I=new(window.AudioContext||window.webkitAudioContext)).createAnalyser()).fftSize=1024,(T=I.createMediaStreamSource(L)).connect(M);let e=new Uint8Array(M.fftSize);(function t(){if(!M||!p.current||!x.current)return;M.getByteTimeDomainData(e);let n=0;for(let t=0;t<e.length;t++){let r=Math.abs((e[t]-128)/128);r>n&&(n=r)}let r=Math.min(100,Math.round(200*n));p.current.style.width=r+"%",x.current.textContent="Level: ".concat(r,"%"),requestAnimationFrame(t)})(),z("Mic stream OK (VU running).")}catch(t){let e=t.name;"NotReadableError"===t.name&&(e="Device busy (close Zoom/Teams/OBS)"),z("Mic stream failed: ".concat(e))}}function U(){if(L&&(L.getTracks().forEach(e=>e.stop()),L=null),T){try{T.disconnect()}catch(e){}T=null}if(I){try{I.close()}catch(e){}I=null}p.current&&x.current&&(p.current.style.width="0%",x.current.textContent="Level: 0%")}function Y(){S&&(clearInterval(S),S=null)}function F(e){if(!v||b||D)return;let t=R||C[0];R=C[Math.min(C.indexOf(t)+1,C.length-1)],q("Restarting"),D=setTimeout(()=>{D=null;try{g&&g.stop()}catch(e){}try{g&&g.start()}catch(e){}},t)}async function Q(e){let t=e&&e.trim()?e.trim():_();i.current&&(i.current.textContent=t||"(no question detected)"),l.current&&(l.current.textContent="Thinking…");try{var n;let e=await fetch("/api/answer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,resume:(null===(n=s.current)||void 0===n?void 0:n.value)||""})});if(!e.ok)throw Error("HTTP "+e.status);let r=await e.json();if(!(null==r?void 0:r.ok)&&(null==r?void 0:r.error))throw Error(JSON.stringify(r.error));l.current&&(l.current.textContent=(r.answer||"").trim()||"(no answer)")}catch(e){l.current&&(l.current.textContent="Error: failed to generate answer.")}}function W(e){var t;let n=((null===(t=document.activeElement)||void 0===t?void 0:t.tagName)||"").toLowerCase();if("textarea"!==n&&"input"!==n&&"Space"===e.code&&(e.preventDefault(),v)){if(b){b=!1,q("Ready"),R=0,E=Date.now();try{g.start()}catch(e){}}else{b=!0,A(!1),q("Idle");try{g.stop()}catch(e){}let e=_();i.current&&(i.current.textContent=e||"(no question detected)"),B(),Q(e)}}}return t.current&&t.current.addEventListener("click",async()=>{var e;if(v)return;let s=!!m;if(d.current&&(d.current.textContent=s?"Yes":"No"),f.current&&(f.current.textContent=window.isSecureContext?"Yes":"No"),!s){z("This browser does not support Web Speech API.");return}if(await P(),k=(null===(e=o.current)||void 0===e?void 0:e.value)||null,await H(),!(g=function(){if(!m)return null;let e=new m;return e.lang="en-US",e.continuous=!0,e.interimResults=!0,e.onstart=()=>{q("Listening"),A(!0),R=0,E=Date.now()},e.onend=()=>{if(A(!1),!v||b){q("Idle");return}F("onend")},e.onerror=e=>{"aborted"!==e.error&&("not-allowed"===e.error?q("Blocked"):q("Error"),F(e.error))},e.onresult=e=>{E=Date.now();for(let t=e.resultIndex;t<e.results.length;t++){let n=e.results[t],r=(n[0].transcript||"").trim();if(r){if(n.isFinal)w+=(w?" ":"")+r,j=O(w),N=[],y="";else{for(let e of r.split(/\s+/).filter(Boolean))(0===N.length||N[N.length-1]!==e)&&N.push(e);y=N.join(" ")}}}r.current&&(r.current.textContent=(w+(y?" "+y:"")).trim(),r.current.scrollTop=r.current.scrollHeight)},e}())){z("Recognizer could not be created.");return}v=!0,b=!1,t.current.disabled=!0,n.current.disabled=!1,B(),i.current&&(i.current.textContent=""),l.current&&(l.current.textContent=""),q("Ready");try{g.start()}catch(e){}Y(),S=setInterval(()=>{v&&!b&&Date.now()-E>1e4&&F("idle")},1500)}),n.current&&n.current.addEventListener("click",()=>{if(v){v=!1,b=!1,t.current&&(t.current.disabled=!1),n.current&&(n.current.disabled=!0);try{g.abort()}catch(e){}A(!1),q("Idle"),Y(),U()}}),u.current&&u.current.addEventListener("click",P),o.current&&o.current.addEventListener("change",async()=>{k=o.current.value||null,await H()}),window.addEventListener("keydown",W),d.current&&(d.current.textContent=m?"Yes":"No"),f.current&&(f.current.textContent=window.isSecureContext?"Yes":"No"),P().catch(()=>{}),()=>{if(v){try{g.abort()}catch(e){}Y(),U()}window.removeEventListener("keydown",W)}})(v),[]),(0,r.jsxs)("div",{className:"relative min-h-screen",children:[(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n:root { --bg:#0b0f14; --panel:#121821; --muted:#9fb0c3; --text:#e8f0fa; --accent:#2a7fff; }\n*{box-sizing:border-box}\nhtml,body{height:100%}\nbody{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}\n.wrap{max-width:1100px;margin:0 auto;padding:20px}\nheader{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}\nh1{margin:0;font-size:22px}\n.status{display:flex;gap:8px}\n.pill{padding:6px 10px;border-radius:999px;font-size:12px;background:#1b2230;color:#ffb7b7;border:1px solid #3a2020}\n.pill.on{color:#b7ffde;border-color:#1f3b2e;background:#102217}\n.pill.off{color:#ffb7b7;border-color:#3a2020;background:#221010}\n.diag{margin:8px 0 14px;padding:10px;border-radius:8px;border:1px solid #3a4660;background:#0f1520}\n.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}\n.meter{width:160px;height:12px;background:#1b2230;border-radius:6px;overflow:hidden;border:1px solid #233048}\n.meter>span{display:block;height:100%;background:#2a7fff;width:0%}\n.muted{color:var(--muted)}\n.controls{display:flex;align-items:center;gap:12px;margin:10px 0 16px}\nbutton{padding:10px 14px;border-radius:8px;border:1px solid #233048;background:#131a25;color:var(--text);font-weight:600;cursor:pointer}\nbutton:disabled{opacity:.5;cursor:not-allowed}\nbutton:hover:not(:disabled){border-color:var(--accent)}\n.hint{color:var(--muted)}\n.columns{display:grid;grid-template-columns:1fr 1fr;gap:16px}\n.col h2{margin:8px 0;color:#d2def0}\ntextarea{width:100%;min-height:220px;padding:12px;border-radius:10px;border:1px solid #233048;background:var(--panel);color:var(--text);resize:vertical}\n.panel{background:var(--panel);border:1px solid #233048;border-radius:10px;padding:12px;min-height:220px;white-space:pre-wrap;line-height:1.45;overflow:auto}\n.qa{margin-top:16px}\n.qa-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}\n.qa-col h3{margin:8px 0;color:#d2def0}\n"}}),(0,r.jsx)("div",{className:"absolute top-6 left-6 z-10",children:(0,r.jsx)(l.default,{href:"/",children:(0,r.jsx)("button",{className:"text-cyan-400 hover:text-cyan-300 transition text-lg font-medium",style:{background:"transparent",border:"none",cursor:"pointer"},children:"← Back to Home"})})}),(0,r.jsxs)("div",{className:"wrap",style:{paddingTop:"80px"},children:[(0,r.jsxs)("header",{children:[(0,r.jsx)("h1",{children:"Interview Assistant — WebKit"}),(0,r.jsxs)("div",{className:"status",children:[(0,r.jsx)("span",{ref:o,className:"pill off",children:"Mic Stopped"}),(0,r.jsx)("span",{ref:u,className:"pill off",children:"Recognizer Idle"})]})]}),(0,r.jsxs)("section",{className:"diag",children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{children:["Support: ",(0,r.jsx)("span",{ref:p,children:"No"})]}),(0,r.jsxs)("div",{children:["\xa0|\xa0 Secure context: ",(0,r.jsx)("span",{ref:x,children:"No"})]})]}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("label",{htmlFor:"deviceSelect",children:"Input device:"}),(0,r.jsx)("select",{ref:d}),(0,r.jsx)("button",{ref:f,children:"Refresh devices"}),(0,r.jsx)("div",{className:"meter",children:(0,r.jsx)("span",{ref:h})}),(0,r.jsx)("span",{ref:m,className:"muted",children:"Level: 0%"})]}),(0,r.jsx)("div",{ref:g,className:"muted"})]}),(0,r.jsxs)("section",{className:"controls",children:[(0,r.jsx)("button",{ref:e,children:"Start Interview"}),(0,r.jsx)("button",{ref:t,disabled:!0,children:"Stop"}),(0,r.jsxs)("div",{className:"hint",children:["Press ",(0,r.jsx)("b",{children:"Spacebar"})," to pause mic & get an answer. Press again to resume."]})]}),(0,r.jsxs)("section",{className:"columns",children:[(0,r.jsxs)("div",{className:"col",children:[(0,r.jsx)("h2",{children:"Your Resume (in memory only)"}),(0,r.jsx)("textarea",{ref:c,placeholder:"Paste your resume here..."})]}),(0,r.jsxs)("div",{className:"col",children:[(0,r.jsx)("h2",{children:"Live Transcript"}),(0,r.jsx)("div",{ref:n,className:"panel","aria-live":"polite"})]})]}),(0,r.jsxs)("section",{className:"qa",children:[(0,r.jsx)("h2",{children:"Last Question & Answer"}),(0,r.jsxs)("div",{className:"qa-row",children:[(0,r.jsxs)("div",{className:"qa-col",children:[(0,r.jsx)("h3",{children:"Detected Question"}),(0,r.jsx)("div",{ref:s,className:"panel"})]}),(0,r.jsxs)("div",{className:"qa-col",children:[(0,r.jsx)("h3",{children:"Assistant Answer"}),(0,r.jsx)("div",{ref:a,className:"panel"})]})]})]})]})]})}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=69636)}),_N_E=e.O()}]);